extends ../../layouts/default
include ../../mixins/alert
include ../../mixins/select-tree
include ../../mixins/noAccess

block main
  if role && role.permissions && role.permissions.includes('products-create')
    .container-fluid
      .col-lg-8.mx-auto
        .card.shadow-sm.border-0
          .card-header.bg-primary.text-white
            h4.mb-0 Thêm sản phẩm mới
          .card-body
            +alert-error(3000)
            form(method="POST", action=`${prefixAdmin}/products/create` enctype="multipart/form-data")
              .form-group.mb-3
                label(for="title") Tên sản phẩm
                input.form-control(type="text", name="title", id="title")
              .form-group.mb-3
                label(for="product_category_id") Thuộc danh mục
                select.form-control(name="product_category_id", id="product_category_id")
                  option(value="") --- Chọn danh mục ---
                  if categories
                    +select-tree(categories)
              .form-group.mb-3
                label(for="desc") Mô tả
                textarea.form-control(name="description", id="description", rows="4")
              .form-group.mb-3
                label(for="price") Giá
                input.form-control(type="number", name="price", id="price", step="1000")
              .form-group.mb-3
                label(for="discount") Giảm giá (%)
                input.form-control(type="number", name="discountPercentage", id="discount", step="1", min="0", max="100")
              .form-group.mb-3
                label(for="stock") Tồn kho
                input.form-control(type="number", name="stock", id="stock", min="0")
              .form-group.mb-3
                label(for="position") Vị trí
                input.form-control(type="number", name="position", id="position", min="1", placeholder="Tự động tăng")
              .form-group.mb-3
                label(for="thumbnail") Ảnh đại diện
                input.form-control-file(type="file", name="thumbnail", id="thumbnail", accept="image/*")
                br
                img#preview-img(src="", alt="Preview", style="max-width: 200px; margin-top: 10px; display: none;")
                br
                button#remove-btn(type="button", style="display: none; margin-top: 5px;" class="btn btn-sm btn-danger") Xóa ảnh
              .form-group.mb-3
                label(for="status") Trạng thái
                select.form-control(name="status", id="status")
                  option(value="active") Hiển thị
                  option(value="inactive") Ẩn
              .d-flex.justify-content-end.mt-4
                button.btn.btn-primary(type="submit")
                  i.fas.fa-save.mr-1
                  | Lưu
                a.btn.btn-secondary.ml-2(href=`${prefixAdmin}/products`)
                  i.fas.fa-arrow-left.mr-1
                  | Quay lại
      script(src="/admin/js/product.js")
  else
    +noAccess()