extends ../../layouts/default.pug

block main
  .container.my-4
    .row
      // Product Image
      .col-md-5.mb-4
        img.img-fluid.rounded(
          src=`/${product.thumbnail}`, 
          alt=product.title,
          style="max-height: 400px; width: 100%; object-fit: contain;"
        )

      // Product Info
      .col-md-7
        h1.mb-3 #{product.title}

        // Price Section
        .price-section.mb-4
          if product.discountPercentage > 0
            h2.text-danger #{product.newPrice.toLocaleString()} VNĐ
            .d-flex.align-items-center
              del.text-muted #{product.price.toLocaleString()} VNĐ
              span.badge.bg-danger.ms-2 -#{product.discountPercentage}%
          else
            h2.text-primary #{product.price.toLocaleString()} VNĐ

        // Stock Status
        .stock-status.mb-3
          if product.stock > 0
            span.text-success Còn hàng (#{product.stock})
          else
            span.text-danger Hết hàng

        // Position
        if product.position
          .position.mb-3
            span.text-muted Vị trí: #{product.position}

        // Description
        .description.mb-4.border-top.pt-3
          h5.fw-bold Mô tả sản phẩm
          .mt-2 !{product.description}

        // Action Buttons
        .action-buttons
          a.btn.btn-primary.me-2(href="#") Thêm vào giỏ hàng
          a.btn.btn-outline-secondary(href="/product") Quay lại

    // Related Products (if available)
    if relatedProducts && relatedProducts.length > 0
      .related-products.mt-5.pt-4.border-top
        h4.mb-4 Sản phẩm cùng loại
        .row
          each item in relatedProducts
            .col-md-3.mb-4
              .card.h-100
                img.card-img-top(
                  src=item.thumbnail, 
                  alt=item.title, 
                  style="height: 150px; object-fit: cover;"
                )
                .card-body
                  h6.card-title
                    a(href=`/product/detail/${item.slug}`)= item.title
                  if item.discountPercentage > 0
                    .text-danger.fw-bold #{item.newPrice.toLocaleString()} VNĐ
                  else
                    .text-primary.fw-bold #{item.price.toLocaleString()} VNĐ
                .card-footer.bg-transparent
                  a.btn.btn-sm.btn-outline-primary(href=`/product/detail/${item.slug}`) Xem chi tiết